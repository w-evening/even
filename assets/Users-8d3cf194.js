import{g as he,m as me,al as ge,_ as T,r as pe,aX as we,w as ve,aE as Se,d as ie,an as fe,c as X,ba as $e,bb as Q,h as _,j as _e,u as Ie,o as ae,ax as be,a as t,b as j,Z as Me,ai as ye,bc as Z,b8 as xe,$ as c,aM as Y,bd as Ce,be as ze,i as ee,k,l as s,n as P,p as $,s as q,F as ne,q as w,t as te,x as r,C as K,bf as Pe,v as Ee,bg as Fe,y as M,bh as Ue,bi as De,bj as He,bk as Re,B as Te,z as Oe,A as Be}from"./index-4b809c19.js";import{M as Ae,S as Le}from"./index-eaa53bee.js";import{u as Ne,_ as Ve,I as We}from"./index-2eaeb946.js";import{_ as Xe,F as je}from"./index-e9441ad8.js";import{_ as ke,E as qe,c as Ke,S as Je}from"./index-abdb43a4.js";import{_ as Ge}from"./index-b9ff95de.js";import{D as Qe}from"./DeleteOutlined-67fd5099.js";import"./useFlexGapSupport-86488050.js";const Ze=e=>{const{componentCls:i}=e,l=`${i}-inner`;return{[i]:{[`&${i}-small`]:{minWidth:e.switchMinWidthSM,height:e.switchHeightSM,lineHeight:`${e.switchHeightSM}px`,[`${i}-inner`]:{paddingInlineStart:e.switchInnerMarginMaxSM,paddingInlineEnd:e.switchInnerMarginMinSM,[`${l}-checked`]:{marginInlineStart:`calc(-100% + ${e.switchPinSizeSM+e.switchPadding*2}px - ${e.switchInnerMarginMaxSM*2}px)`,marginInlineEnd:`calc(100% - ${e.switchPinSizeSM+e.switchPadding*2}px + ${e.switchInnerMarginMaxSM*2}px)`},[`${l}-unchecked`]:{marginTop:-e.switchHeightSM,marginInlineStart:0,marginInlineEnd:0}},[`${i}-handle`]:{width:e.switchPinSizeSM,height:e.switchPinSizeSM},[`${i}-loading-icon`]:{top:(e.switchPinSizeSM-e.switchLoadingIconSize)/2,fontSize:e.switchLoadingIconSize},[`&${i}-checked`]:{[`${i}-inner`]:{paddingInlineStart:e.switchInnerMarginMinSM,paddingInlineEnd:e.switchInnerMarginMaxSM,[`${l}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${l}-unchecked`]:{marginInlineStart:`calc(100% - ${e.switchPinSizeSM+e.switchPadding*2}px + ${e.switchInnerMarginMaxSM*2}px)`,marginInlineEnd:`calc(-100% + ${e.switchPinSizeSM+e.switchPadding*2}px - ${e.switchInnerMarginMaxSM*2}px)`}},[`${i}-handle`]:{insetInlineStart:`calc(100% - ${e.switchPinSizeSM+e.switchPadding}px)`}},[`&:not(${i}-disabled):active`]:{[`&:not(${i}-checked) ${l}`]:{[`${l}-unchecked`]:{marginInlineStart:e.marginXXS/2,marginInlineEnd:-e.marginXXS/2}},[`&${i}-checked ${l}`]:{[`${l}-checked`]:{marginInlineStart:-e.marginXXS/2,marginInlineEnd:e.marginXXS/2}}}}}}},Ye=e=>{const{componentCls:i}=e;return{[i]:{[`${i}-loading-icon${e.iconCls}`]:{position:"relative",top:(e.switchPinSize-e.fontSize)/2,color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${i}-checked ${i}-loading-icon`]:{color:e.switchColor}}}},en=e=>{const{componentCls:i}=e,l=`${i}-handle`;return{[i]:{[l]:{position:"absolute",top:e.switchPadding,insetInlineStart:e.switchPadding,width:e.switchPinSize,height:e.switchPinSize,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:e.colorWhite,borderRadius:e.switchPinSize/2,boxShadow:e.switchHandleShadow,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${i}-checked ${l}`]:{insetInlineStart:`calc(100% - ${e.switchPinSize+e.switchPadding}px)`},[`&:not(${i}-disabled):active`]:{[`${l}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${i}-checked ${l}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},nn=e=>{const{componentCls:i}=e,l=`${i}-inner`;return{[i]:{[l]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:e.switchInnerMarginMax,paddingInlineEnd:e.switchInnerMarginMin,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${l}-checked, ${l}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none"},[`${l}-checked`]:{marginInlineStart:`calc(-100% + ${e.switchPinSize+e.switchPadding*2}px - ${e.switchInnerMarginMax*2}px)`,marginInlineEnd:`calc(100% - ${e.switchPinSize+e.switchPadding*2}px + ${e.switchInnerMarginMax*2}px)`},[`${l}-unchecked`]:{marginTop:-e.switchHeight,marginInlineStart:0,marginInlineEnd:0}},[`&${i}-checked ${l}`]:{paddingInlineStart:e.switchInnerMarginMin,paddingInlineEnd:e.switchInnerMarginMax,[`${l}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${l}-unchecked`]:{marginInlineStart:`calc(100% - ${e.switchPinSize+e.switchPadding*2}px + ${e.switchInnerMarginMax*2}px)`,marginInlineEnd:`calc(-100% + ${e.switchPinSize+e.switchPadding*2}px - ${e.switchInnerMarginMax*2}px)`}},[`&:not(${i}-disabled):active`]:{[`&:not(${i}-checked) ${l}`]:{[`${l}-unchecked`]:{marginInlineStart:e.switchPadding*2,marginInlineEnd:-e.switchPadding*2}},[`&${i}-checked ${l}`]:{[`${l}-checked`]:{marginInlineStart:-e.switchPadding*2,marginInlineEnd:e.switchPadding*2}}}}}},tn=e=>{const{componentCls:i}=e;return{[i]:T(T(T(T({},pe(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:e.switchMinWidth,height:e.switchHeight,lineHeight:`${e.switchHeight}px`,verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${i}-disabled)`]:{background:e.colorTextTertiary}}),we(e)),{[`&${i}-checked`]:{background:e.switchColor,[`&:hover:not(${i}-disabled)`]:{background:e.colorPrimaryHover}},[`&${i}-loading, &${i}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${i}-rtl`]:{direction:"rtl"}})}},an=he("Switch",e=>{const i=e.fontSize*e.lineHeight,l=e.controlHeight/2,h=2,v=i-h*2,u=l-h*2,m=me(e,{switchMinWidth:v*2+h*4,switchHeight:i,switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchInnerMarginMin:v/2,switchInnerMarginMax:v+h+h*2,switchPadding:h,switchPinSize:v,switchBg:e.colorBgContainer,switchMinWidthSM:u*2+h*2,switchHeightSM:l,switchInnerMarginMinSM:u/2,switchInnerMarginMaxSM:u+h+h*2,switchPinSizeSM:u,switchHandleShadow:`0 2px 4px 0 ${new ge("#00230b").setAlpha(.2).toRgbString()}`,switchLoadingIconSize:e.fontSizeIcon*.75,switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[tn(m),nn(m),en(m),Ye(m),Ze(m)]}),ln=Se("small","default"),sn=()=>({id:String,prefixCls:String,size:c.oneOf(ln),disabled:{type:Boolean,default:void 0},checkedChildren:c.any,unCheckedChildren:c.any,tabindex:c.oneOfType([c.string,c.number]),autofocus:{type:Boolean,default:void 0},loading:{type:Boolean,default:void 0},checked:c.oneOfType([c.string,c.number,c.looseBool]),checkedValue:c.oneOfType([c.string,c.number,c.looseBool]).def(!0),unCheckedValue:c.oneOfType([c.string,c.number,c.looseBool]).def(!1),onChange:{type:Function},onClick:{type:Function},onKeydown:{type:Function},onMouseup:{type:Function},"onUpdate:checked":{type:Function},onBlur:Function,onFocus:Function}),on=ie({compatConfig:{MODE:3},name:"ASwitch",__ANT_SWITCH:!0,inheritAttrs:!1,props:sn(),slots:Object,setup(e,i){let{attrs:l,slots:h,expose:v,emit:u}=i;const m=Ne(),y=fe(),I=X(()=>{var n;return(n=e.disabled)!==null&&n!==void 0?n:y.value});$e(()=>{Q(),Q()});const E=_(e.checked!==void 0?e.checked:l.defaultChecked),H=X(()=>E.value===e.checkedValue);_e(()=>e.checked,()=>{E.value=e.checked});const{prefixCls:g,direction:O,size:B}=Ie("switch",e),[A,S]=an(g),x=_(),R=()=>{var n;(n=x.value)===null||n===void 0||n.focus()};v({focus:R,blur:()=>{var n;(n=x.value)===null||n===void 0||n.blur()}}),ae(()=>{be(()=>{e.autofocus&&!I.value&&x.value.focus()})});const F=(n,d)=>{I.value||(u("update:checked",n),u("change",n,d),m.onFieldChange())},z=n=>{u("blur",n)},U=n=>{R();const d=H.value?e.unCheckedValue:e.checkedValue;F(d,n),u("click",d,n)},L=n=>{n.keyCode===Y.LEFT?F(e.unCheckedValue,n):n.keyCode===Y.RIGHT&&F(e.checkedValue,n),u("keydown",n)},N=n=>{var d;(d=x.value)===null||d===void 0||d.blur(),u("mouseup",n)},o=X(()=>({[`${g.value}-small`]:B.value==="small",[`${g.value}-loading`]:e.loading,[`${g.value}-checked`]:H.value,[`${g.value}-disabled`]:I.value,[g.value]:!0,[`${g.value}-rtl`]:O.value==="rtl",[S.value]:!0}));return()=>{var n;return A(t(xe,null,{default:()=>[t("button",j(j(j({},Me(e,["prefixCls","checkedChildren","unCheckedChildren","checked","autofocus","checkedValue","unCheckedValue","id","onChange","onUpdate:checked"])),l),{},{id:(n=e.id)!==null&&n!==void 0?n:m.id.value,onKeydown:L,onClick:U,onBlur:z,onMouseup:N,type:"button",role:"switch","aria-checked":E.value,disabled:I.value||e.loading,class:[l.class,o.value],ref:x}),[t("div",{class:`${g.value}-handle`},[e.loading?t(ye,{class:`${g.value}-loading-icon`},null):null]),t("span",{class:`${g.value}-inner`},[t("span",{class:`${g.value}-inner-checked`},[Z(h,e,"checkedChildren")]),t("span",{class:`${g.value}-inner-unchecked`},[Z(h,e,"unCheckedChildren")])])])]}))}}}),dn=ve(on),vn=ie({__name:"Users",setup(e){const i=_("small"),l=_("");ae(async()=>{(await Ce(O)).data.users.forEach(d=>{v.value.push(d)}),(await ze()).data.forEach(d=>{U.value.push(d)})});const h=[{title:"用户ID",dataIndex:"id"},{title:"用户名",dataIndex:"username"},{title:"邮箱",dataIndex:"email"},{title:"电话",dataIndex:"mobile"},{title:"角色",dataIndex:"role_name"},{title:"状态",dataIndex:"mg_state"},{title:"操作",dataIndex:"operation"}],v=_([]),u=_(!1),m=_(!1),y=_(!1),I=o=>{u.value=o},E=(o,n)=>{m.value=o,r.state.editUser=n},H=(o,n,d)=>{y.value=o,r.state.userRole=n,r.state.index=d},g=o=>{console.log("use value",o),o!=""&&(v.value=v.value.filter(n=>JSON.stringify(n).includes(o)))},O=ee({query:"",pagenum:1,pagesize:10}),B=(o,n)=>{console.log(o,n),Fe(o,n).then(d=>{M.success(d.meta.msg)})},A=o=>{let n=Number(o);Ue(n).then(d=>{M.success(d.meta.msg)}).catch(d=>{M.error(d.meta.msg)})},S=ee({username:"",password:"",email:"",mobile:""}),x=o=>{console.log("Success:",o),De(o).then(n=>{M.success(n.meta.msg),setTimeout(()=>{I(!1)},1e3)}).catch(n=>{M.error(n.meta.msg)})},R=o=>{console.log("Failed:",o)},J=o=>{let n=r.state.edit.id;He(n,o).then(d=>{console.log(d.data),M.success(d.meta.msg)}).catch(d=>{M.error(d.meta.msg)})},F=o=>{console.log("Failed:",o)};let z=_([]);const U=_([]),L=o=>{var d;console.log(`${o}`);const n=(d=U.value)==null?void 0:d.filter(b=>JSON.stringify(b).includes(o));r.state.editRoleID.rid=n[0].id},N=()=>{console.log(r.state.editRoleID),console.log(r.state.userRole.id),Re(r.state.userRole.id,r.state.editRoleID).then(o=>{console.log(o),M.success(o.meta.msg)})};return(o,n)=>{const d=Ve,b=We,p=Xe,f=Te,G=je,V=Ae,le=Ge,se=dn,W=Oe,oe=Be,de=ke,ce=Je,re=Ke;return P(),k("div",null,[t(le,{direction:"horizontal"},{default:s(()=>[t(d,{value:l.value,"onUpdate:value":n[0]||(n[0]=a=>l.value=a),placeholder:"input search text","enter-button":"",onSearch:g},null,8,["value"]),t(V,{open:u.value,"onUpdate:open":n[6]||(n[6]=a=>u.value=a),onOk:n[7]||(n[7]=a=>I(!1)),footer:null},{default:s(()=>[t(G,{class:"mt-20px",model:S,name:"horizontal_login",layout:"horizontal",autocomplete:"off",onFinish:x,onFinishFailed:R},{default:s(()=>[t(p,{label:"用户名",name:"username",rules:[{required:!0,message:"Please input your username!"}]},{default:s(()=>[t(b,{value:S.username,"onUpdate:value":n[1]||(n[1]=a=>S.username=a)},null,8,["value"])]),_:1}),t(p,{label:"密码",name:"password",rules:[{required:!0,message:"Please input your password!"}]},{default:s(()=>[t(b,{value:S.password,"onUpdate:value":n[2]||(n[2]=a=>S.password=a)},null,8,["value"])]),_:1}),t(p,{label:"邮箱",name:"email",rules:[{required:!0,message:"Please input your email!"}]},{default:s(()=>[t(b,{value:S.email,"onUpdate:value":n[3]||(n[3]=a=>S.email=a)},null,8,["value"])]),_:1}),t(p,{label:"手机",name:"phone",rules:[{required:!0,message:"Please input your phone!"}]},{default:s(()=>[t(b,{value:S.mobile,"onUpdate:value":n[4]||(n[4]=a=>S.mobile=a)},null,8,["value"])]),_:1}),t(p,{class:"text-right"},{default:s(()=>[t(f,{onClick:n[5]||(n[5]=a=>I(!1))},{default:s(()=>[$("取消")]),_:1}),t(f,{type:"primary","html-type":"submit"},{default:s(()=>[$("确定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),t(f,{type:"primary",onClick:n[8]||(n[8]=a=>I(!0))},{default:s(()=>[$("添加用户")]),_:1})]),_:1}),t(de,{"row-key":a=>a.id,bordered:"","data-source":v.value,columns:h},{bodyCell:s(({column:a,record:C,index:ue})=>[a.dataIndex==="mg_state"?(P(),q(se,{key:0,checked:C.mg_state,"onUpdate:checked":D=>C.mg_state=D,onChange:D=>B(C.id,C.mg_state)},null,8,["checked","onUpdate:checked","onChange"])):a.dataIndex==="operation"?(P(),k(ne,{key:1},[t(W,{title:"编辑"},{default:s(()=>[t(f,{size:i.value,type:"primary",onClick:D=>E(!0,C)},{default:s(()=>[t(w(qe))]),_:2},1032,["size","onClick"])]),_:2},1024),v.value.length?(P(),q(oe,{key:0,title:"确定删除?",onConfirm:D=>A(C.id)},{default:s(()=>[t(W,{title:"删除"},{default:s(()=>[t(f,{size:i.value,type:"primary",danger:"",onClick:n[9]||(n[9]=()=>{})},{default:s(()=>[t(w(Qe))]),_:1},8,["size"])]),_:1})]),_:2},1032,["onConfirm"])):te("",!0),t(W,{title:"分配角色"},{default:s(()=>[t(f,{size:i.value,type:"primary",onClick:D=>H(!0,C,ue)},{default:s(()=>[t(w(Le))]),_:2},1032,["size","onClick"])]),_:2},1024)],64)):te("",!0)]),_:1},8,["row-key","data-source"]),t(V,{title:"编辑用户",open:m.value,"onUpdate:open":n[14]||(n[14]=a=>m.value=a),footer:null,onOk:n[15]||(n[15]=a=>m.value=!1)},{default:s(()=>[t(G,{class:"mt-20px",model:w(r).state.editUser,name:"horizontal_login",layout:"horizontal",autocomplete:"off",onFinish:J,onFinishFailed:F},{default:s(()=>[t(p,{label:"用户名",name:"username"},{default:s(()=>[t(b,{disabled:!0,value:w(r).state.editUser.username,"onUpdate:value":n[10]||(n[10]=a=>w(r).state.editUser.username=a)},null,8,["value"])]),_:1}),t(p,{label:"邮箱",name:"email"},{default:s(()=>[t(b,{value:w(r).state.editUser.email,"onUpdate:value":n[11]||(n[11]=a=>w(r).state.editUser.email=a)},null,8,["value"])]),_:1}),t(p,{label:"手机",name:"mobile"},{default:s(()=>[t(b,{value:w(r).state.editUser.mobile,"onUpdate:value":n[12]||(n[12]=a=>w(r).state.editUser.mobile=a)},null,8,["value"])]),_:1}),t(p,{class:"text-right"},{default:s(()=>[t(f,{onClick:n[13]||(n[13]=a=>m.value=!1)},{default:s(()=>[$("取消")]),_:1}),t(f,{type:"primary","html-type":"submit"},{default:s(()=>[$("确定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),t(V,{title:"分配角色",open:y.value,"onUpdate:open":n[18]||(n[18]=a=>y.value=a),footer:null,onOk:n[19]||(n[19]=a=>y.value=!1)},{default:s(()=>[t(p,{label:"当前用户："},{default:s(()=>[$(K(w(r).state.userRole.username),1)]),_:1}),t(p,{label:"当前角色："},{default:s(()=>[$(K(w(r).state.userRole.role_name),1)]),_:1}),t(p,{label:"分配新角色"},{default:s(()=>[t(re,{ref:"select",value:w(z),"onUpdate:value":n[16]||(n[16]=a=>Pe(z)?z.value=a:z=a),placeholder:"请选择角色",style:{width:"120px"},onChange:L},{default:s(()=>[(P(!0),k(ne,null,Ee(U.value,a=>(P(),q(ce,{value:a.roleName,key:a.id},{default:s(()=>[$(K(a.roleName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(p,{class:"text-right"},{default:s(()=>[t(f,{onClick:n[17]||(n[17]=a=>y.value=!1)},{default:s(()=>[$("取消")]),_:1}),t(f,{type:"primary",onClick:N},{default:s(()=>[$("确定")]),_:1})]),_:1})]),_:1},8,["open"])])}}});export{vn as default};
