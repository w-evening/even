import{w as oe,g as ce,m as pe,_ as T,r as me,d as ne,u as fe,c as E,f as ge,a as t,b as ee,e as S,o as _e,h as w,i as he,j as X,k as F,l as o,B as ve,n as _,p as f,F as H,q as h,s as O,t as te,v as Y,x as s,y as k,z as ye,A as xe,C as J}from"./index-4b809c19.js";import{M as $e,S as be}from"./index-eaa53bee.js";import{_ as Ce,E as we,a as ke}from"./index-abdb43a4.js";import{D as Se}from"./DeleteOutlined-67fd5099.js";import{I as ze}from"./index-2eaeb946.js";import{C as Re,_ as De,F as Ie}from"./index-e9441ad8.js";import{_ as Me}from"./index-36347180.js";import{_ as Ne}from"./index-39636341.js";import"./useFlexGapSupport-86488050.js";const Ee=oe(Re),Fe=n=>{const{componentCls:l,sizePaddingEdgeHorizontal:v,colorSplit:c,lineWidth:d}=n;return{[l]:T(T({},me(n)),{borderBlockStart:`${d}px solid ${c}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",margin:`0 ${n.dividerVerticalGutterMargin}px`,verticalAlign:"middle",borderTop:0,borderInlineStart:`${d}px solid ${c}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${n.dividerHorizontalGutterMargin}px 0`},[`&-horizontal${l}-with-text`]:{display:"flex",alignItems:"center",margin:`${n.dividerHorizontalWithTextGutterMargin}px 0`,color:n.colorTextHeading,fontWeight:500,fontSize:n.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${c}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${d}px solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${l}-with-text-left`]:{"&::before":{width:"5%"},"&::after":{width:"95%"}},[`&-horizontal${l}-with-text-right`]:{"&::before":{width:"95%"},"&::after":{width:"5%"}},[`${l}-inner-text`]:{display:"inline-block",padding:"0 1em"},"&-dashed":{background:"none",borderColor:c,borderStyle:"dashed",borderWidth:`${d}px 0 0`},[`&-horizontal${l}-with-text${l}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${l}-dashed`]:{borderInlineStart:d,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${l}-with-text`]:{color:n.colorText,fontWeight:"normal",fontSize:n.fontSize},[`&-horizontal${l}-with-text-left${l}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${l}-inner-text`]:{paddingInlineStart:v}},[`&-horizontal${l}-with-text-right${l}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${l}-inner-text`]:{paddingInlineEnd:v}}})}},Ke=ce("Divider",n=>{const l=pe(n,{dividerVerticalGutterMargin:n.marginXS,dividerHorizontalWithTextGutterMargin:n.margin,dividerHorizontalGutterMargin:n.marginLG});return[Fe(l)]},{sizePaddingEdgeHorizontal:0}),Be=()=>({prefixCls:String,type:{type:String,default:"horizontal"},dashed:{type:Boolean,default:!1},orientation:{type:String,default:"center"},plain:{type:Boolean,default:!1},orientationMargin:[String,Number]}),Ue=ne({name:"ADivider",inheritAttrs:!1,compatConfig:{MODE:3},props:Be(),setup(n,l){let{slots:v,attrs:c}=l;const{prefixCls:d,direction:y}=fe("divider",n),[x,z]=Ke(d),K=E(()=>n.orientation==="left"&&n.orientationMargin!=null),B=E(()=>n.orientation==="right"&&n.orientationMargin!=null),$=E(()=>{const{type:m,dashed:b,plain:V}=n,p=d.value;return{[p]:!0,[z.value]:!!z.value,[`${p}-${m}`]:!0,[`${p}-dashed`]:!!b,[`${p}-plain`]:!!V,[`${p}-rtl`]:y.value==="rtl",[`${p}-no-default-orientation-margin-left`]:K.value,[`${p}-no-default-orientation-margin-right`]:B.value}}),W=E(()=>{const m=typeof n.orientationMargin=="number"?`${n.orientationMargin}px`:n.orientationMargin;return T(T({},K.value&&{marginLeft:m}),B.value&&{marginRight:m})}),P=E(()=>n.orientation.length>0?"-"+n.orientation:n.orientation);return()=>{var m;const b=ge((m=v.default)===null||m===void 0?void 0:m.call(v));return x(t("div",ee(ee({},c),{},{class:[$.value,b.length?`${d.value}-with-text ${d.value}-with-text${P.value}`:"",c.class],role:"separator"}),[b.length?t("span",{class:`${d.value}-inner-text`,style:W.value},[b]):null]))}}}),Ae=oe(Ue),Ge=()=>S("roles","get"),He=n=>S("roles","post",n),Oe=(n,l)=>S(`roles/${n}`,"put",l),Te=n=>S(`roles/${n}`,"delete"),We=(n,l)=>S(`roles/${n}/rights/`,"post",l),Pe=(n,l)=>S(`roles/${n}/rights/${l}`,"delete"),Ve=()=>S("rights/tree","get"),ot=ne({__name:"role",setup(n){_e(()=>{l()});async function l(){const i=await Ge();c.value=i.data,Q=(await Ve()).data}const v=[{title:"角色ID",dataIndex:"id",key:"id"},{title:"角色名称",dataIndex:"roleName",key:"roleName"},{title:"角色描述",dataIndex:"roleDesc",key:"roleDesc"},{title:"操作",dataIndex:"operation",key:"operation"}],c=w([]),d=w(!1),y=w(!1),x=w(!1),z=i=>{d.value=i},K=(i,e)=>{y.value=i,s.state.editRole=e},B=(i,e)=>{x.value=i,s.state.RoleID=e.id,e.children.forEach(r=>{s.state.data1.push(r.id),r.children.forEach(g=>{s.state.data2.push(g.id),g.children.forEach(u=>{s.state.data3.push(u.id)})})}),s.state.data4=[...s.state.data1,...s.state.data2,...s.state.data3],D.value=s.state.data4,I.value=s.state.data4,R.value=s.state.data4},$=he({roleName:"",roleDesc:""}),W=i=>{console.log("Success:",i),He(i).then(e=>{k.success(e.meta.msg),l()})},P=i=>{console.log("Failed:",i)},m=i=>{let e=s.state.editRole.id;Oe(e,i).then(r=>{k.success(r.meta.msg),l()}).catch(r=>{k.error(r.meta.msg)})},b=i=>{console.log("Failed:",i)},V=i=>{let e=Number(i);Te(e).then(r=>{k.success(r.meta.msg),l()}).catch(r=>{k.error(r.meta.msg)})},p=(i,e)=>{Pe(i,e).then(r=>{k.success(r.meta.msg),l()})},ae={children:"children",title:"authName",key:"id"};let Q=[];const D=w([]),I=w([]),R=w([]);X(D,()=>{console.log("expandedKeys",D)}),X(I,()=>{console.log("selectedKeys",I)}),X(R,()=>{console.log("checkedKeys",R)});const le=()=>{const i=Number(s.state.RoleID),e={rids:R.value.join(",")};console.log(i,e),We(i,e).then(r=>{k.success(r.meta.msg),l()})};return(i,e)=>{const r=ze,g=De,u=ve,Z=Ie,L=$e,j=ye,ie=xe,q=Ne,M=Ee,U=Me,re=Ae,se=Ce,de=ke;return _(),F("div",null,[t(L,{open:d.value,"onUpdate:open":e[3]||(e[3]=a=>d.value=a),onOk:e[4]||(e[4]=a=>z(!1)),footer:null},{default:o(()=>[t(Z,{class:"mt-20px",model:$,name:"horizontal_login",layout:"horizontal",autocomplete:"off",onFinish:W,onFinishFailed:P},{default:o(()=>[t(g,{label:"角色名称",name:"roleName",rules:[{required:!0,message:"Please input your username!"}]},{default:o(()=>[t(r,{value:$.roleName,"onUpdate:value":e[0]||(e[0]=a=>$.roleName=a)},null,8,["value"])]),_:1}),t(g,{label:"角色描述",name:"roleDesc",rules:[{required:!0,message:"Please input your password!"}]},{default:o(()=>[t(r,{value:$.roleDesc,"onUpdate:value":e[1]||(e[1]=a=>$.roleDesc=a)},null,8,["value"])]),_:1}),t(g,{class:"text-right"},{default:o(()=>[t(u,{onClick:e[2]||(e[2]=a=>z(!1))},{default:o(()=>[f("取消")]),_:1}),t(u,{type:"primary","html-type":"submit"},{default:o(()=>[f("确定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),t(u,{type:"primary",onClick:e[5]||(e[5]=a=>z(!0))},{default:o(()=>[f("添加角色")]),_:1}),t(se,{"row-key":a=>a.id,columns:v,"data-source":c.value,bordered:"",childrenColumnName:"null"},{bodyCell:o(({column:a,record:C})=>[a.key==="operation"?(_(),F(H,{key:0},[t(j,{title:"编辑"},{default:o(()=>[t(u,{type:"primary",onClick:N=>K(!0,C)},{default:o(()=>[t(h(we))]),_:2},1032,["onClick"])]),_:2},1024),c.value.length?(_(),O(ie,{key:0,title:"确定删除?",onConfirm:N=>V(C.id)},{default:o(()=>[t(j,{title:"删除"},{default:o(()=>[t(u,{type:"primary",danger:""},{default:o(()=>[t(h(Se))]),_:1})]),_:1})]),_:2},1032,["onConfirm"])):te("",!0),t(j,{title:"分配权限"},{default:o(()=>[t(u,{type:"primary",onClick:N=>B(!0,C)},{default:o(()=>[t(h(be))]),_:2},1032,["onClick"])]),_:2},1024)],64)):te("",!0)]),expandedRowRender:o(({record:a})=>[(_(!0),F(H,null,Y(a.children,(C,N)=>(_(),O(U,{key:C.id,class:"mb-10px"},{default:o(()=>[t(M,{span:6},{default:o(()=>[t(q,{class:"px-7px py-5px",closable:"",color:"#2db7f5",onClose:A=>p(a.id,C.id)},{default:o(()=>[f(J(C.authName),1)]),_:2},1032,["onClose"])]),_:2},1024),t(M,{span:18},{default:o(()=>[(_(!0),F(H,null,Y(a.children[N].children,(A,ue)=>(_(),O(U,{key:A.id},{default:o(()=>[t(M,{span:6},{default:o(()=>[t(q,{class:"px-7px py-5px",closable:"",color:"#87d068",onClose:G=>p(a.id,A.id)},{default:o(()=>[f(J(A.authName),1)]),_:2},1032,["onClose"])]),_:2},1024),t(M,{span:18,class:"flex flex-wrap"},{default:o(()=>[(_(!0),F(H,null,Y(a.children[N].children[ue].children,G=>(_(),O(U,{key:G.id},{default:o(()=>[t(q,{class:"px-7px py-5px mb-10px mr-10px",closable:"",color:"orange",onClose:Le=>p(a.id,G.id)},{default:o(()=>[f(J(G.authName),1)]),_:2},1032,["onClose"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),t(re)]),_:2},1024))),128))]),_:1},8,["row-key","data-source"]),t(L,{title:"编辑角色",open:y.value,"onUpdate:open":e[9]||(e[9]=a=>y.value=a),footer:null,onOk:e[10]||(e[10]=a=>y.value=!1)},{default:o(()=>[t(Z,{class:"mt-20px",model:h(s).state.editRole,name:"horizontal_login",layout:"horizontal",autocomplete:"off",onFinish:m,onFinishFailed:b},{default:o(()=>[t(g,{label:"角色名称",name:"roleName"},{default:o(()=>[t(r,{value:h(s).state.editRole.roleName,"onUpdate:value":e[6]||(e[6]=a=>h(s).state.editRole.roleName=a)},null,8,["value"])]),_:1}),t(g,{label:"角色描述",name:"roleDesc"},{default:o(()=>[t(r,{value:h(s).state.editRole.roleDesc,"onUpdate:value":e[7]||(e[7]=a=>h(s).state.editRole.roleDesc=a)},null,8,["value"])]),_:1}),t(g,{class:"text-right"},{default:o(()=>[t(u,{onClick:e[8]||(e[8]=a=>y.value=!1)},{default:o(()=>[f("取消")]),_:1}),t(u,{type:"primary","html-type":"submit"},{default:o(()=>[f("确定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),t(L,{title:"分配权限",open:x.value,"onUpdate:open":e[15]||(e[15]=a=>x.value=a),footer:null,onOk:e[16]||(e[16]=a=>x.value=!1)},{default:o(()=>[t(de,{expandedKeys:D.value,"onUpdate:expandedKeys":e[11]||(e[11]=a=>D.value=a),selectedKeys:I.value,"onUpdate:selectedKeys":e[12]||(e[12]=a=>I.value=a),checkedKeys:R.value,"onUpdate:checkedKeys":e[13]||(e[13]=a=>R.value=a),checkable:"","tree-data":h(Q),"field-names":ae},null,8,["expandedKeys","selectedKeys","checkedKeys","tree-data"]),t(U,null,{default:o(()=>[t(M,{span:24,class:"text-right"},{default:o(()=>[t(u,{onClick:e[14]||(e[14]=a=>x.value=!1)},{default:o(()=>[f("取消")]),_:1}),t(u,{type:"primary",onClick:le},{default:o(()=>[f("确定")]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])}}});export{ot as default};
